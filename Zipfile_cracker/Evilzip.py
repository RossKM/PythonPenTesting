import zipfile
import argparse 
from threading import Thread

def extract_file(zfile, password):   # Extracts the contents of the zip file.
    try:
        zfile.extractall(pwd=password.encode('utf-8'))
        print(f'[+] Found password: {password}\n')
    except RuntimeError:
        pass


def main(zname, dname): # zname is zipfile name and dname is dictionary file name.
    z_file = zipfile.ZipFile(zname) # Open the zipfile.
    with open(dname) as pass_file:
        for line in pass_file.readlines():  # Reads the lines in a password file.
            password = line.strip('\n')
            t = Thread(target=extract_file, args=(z_file, password))
            t.start()
if __name__ == '__main__':  #   This part of the file allows the user to specify the name of both the dict file and the zip file.
    parser = argparse.ArgumentParser(usage='Evilzip.py ZIPFILE DICTFILE')
    parser.add_argument('zipfile', type=str, metavar='ZIPFILE', help='specify zip file')    #   Specifies the zip file
    parser.add_argument('dictfile', type=str, metavar='DICTFILE', help='specify dict file')   #   Specifies the dict file
    args = parser.parse_args()
    main(args.zipfile, args.dictfile)
