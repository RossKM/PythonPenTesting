# Python script that checks an FTP directory for web pages and returns them to the user.

import ftplib


def return_default(ftp):
	try:
		dir_list = ftp.nlst()
	except Exception as e:
		print(f'[-] Could not list directory contents.\n'
		f'[-] Skipping to next Target.\n'
		f'[-] Exception: {e}')
		return


	ret_list = []
	for file in dir_list: # Looks through the directory list for web pages.
		fn = file.lower()
		if '.php' in fn or 'htm' in fn or '.asp' in fn: # different web pages files.
			print(f'[+] Found default pages {file}')
		else:
			print('[-] Nothing has been found')
		ret_list.append(file) # adds the found file to a list of web pages found.
	return ret_list

if __name__ == '__main__':
	tgt_host = '192.168.1.203'
	username = 'ftpuser'
	password = 'password' # use the credentials gained from a brute force script.

	ftp_conn = ftplib.FTP(tgt_host) # connects to target machine using ftplib.
	ftp_conn.login(username, password) # uses the username and password defined.
	return_default(ftp_conn)

